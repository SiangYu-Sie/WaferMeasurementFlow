# 晶圓量測流程系統 (WaferMeasurementFlow) 使用手冊

> **版本**: 2.0  
> **最後更新**: 2026-02-11  
> **適用平台**: Windows (.NET Framework / WinForms)

---

## 目錄

1. [系統概述](#1-系統概述)
2. [系統架構](#2-系統架構)
3. [安裝與啟動](#3-安裝與啟動)
4. [主畫面 (MainForm)](#4-主畫面-mainform)
5. [載具管理 (Carrier Management)](#5-載具管理-carrier-management)
6. [工單管理 (PJ/CJ 建立與執行)](#6-工單管理-pjcj-建立與執行)
7. [Recipe 管理 (Recipe Editor)](#7-recipe-管理-recipe-editor)
8. [SECS/GEM 監控 (SecsMonitorForm)](#8-secsgem-監控-secsmonitorform)
9. [ETEL 驅動測試 (EtelTestForm)](#9-etel-驅動測試-eteltestform)
10. [系統事件與日誌](#10-系統事件與日誌)
11. [狀態定義與參考](#11-狀態定義與參考)
12. [錯誤排除 (Troubleshooting)](#12-錯誤排除-troubleshooting)
13. [附錄：SEMI 標準對照](#13-附錄semi-標準對照)

---

## 1. 系統概述

**晶圓量測流程系統 (WaferMeasurementFlow)** 是一套半導體設備控制軟體，用於管理晶圓的量測加工流程。系統遵循 SEMI 國際半導體標準，整合以下核心功能：

- **Load Port 管理**：支援 2 組裝載埠的載具放置、夾持、艙門控制、晶圓掃描 (Mapping) 與卸載
- **工單系統**：符合 SEMI E40 (Process Job) 與 E94 (Control Job) 規範的工單建立與自動化執行
- **機器手臂控制**：自動化晶圓搬運 (Pick → Align → Process → Return)
- **SECS/GEM 通訊**：透過 DIASECSGEM SDK 實現 Host-Equipment 通訊
- **ETEL 驅動控制**：支援 ETEL 運動控制器的連線與參數讀寫
- **Recipe 管理**：量測 Recipe 的建立、編輯與刪除

---

## 2. 系統架構

### 2.1 模組架構圖

```
Program.cs (啟動入口, DI 容器)
  └── Equipment (系統根物件,Singleton)
       ├── LoadPortAgent × 2    ← 裝載埠代理 (E87 駐指)
       │    └── E87Manager      ← Carrier ID / SlotMap 驗證
       ├── RobotAgent           ← 機器手臂代理
       ├── AlignerAgent         ← 對位器代理
       ├── ControlJobAgent      ← CJ/PJ 排程與執行引擎
       │    ├── ProcessManager  ← 晶圓加工處理
       │    └── WaferManager    ← 晶圓全域追蹤
       ├── RecipeManager        ← Recipe 管理
       ├── SecsManager          ← SECS/GEM 通訊 (DIASECSGEM)
       └── LogSystem            ← 系統日誌
```

### 2.2 畫面結構

| 畫面 | 類別名稱 | 功能 |
|------|---------|------|
| 主畫面 | `MainForm` | 系統總覽、Port 狀態、快速操作 |
| 工單建立 | `PJCJCreationForm` | 建立 Process Job / Control Job |
| Recipe 編輯 | `RecipeEditorForm` | Recipe 的 CRUD 操作 |
| SECS 監控 | `SecsMonitorForm` | SECS/GEM 驅動、通訊、控制模式管理 |
| ETEL 測試 | `EtelTestForm` | ETEL 運動控制器連線與參數讀寫 |

### 2.3 事件驅動模型

系統使用 `SystemEventBus` 作為全域事件匯流排，所有模組透過事件驅動即時更新 UI：

| 事件 | 觸發時機 |
|------|---------|
| `LoadPortStateChanged` | Load Port 狀態變更 (Empty → Present → Clamped → ...) |
| `CarrierStateChanged` | 載具內容變更 (Wafer 被取走或放回) |
| `SubstrateStateChanged` | 晶圓狀態變更 (Present → Picked → Processing → Processed) |
| `LogMessagePublished` | 任何模組發出日誌訊息 |

---

## 3. 安裝與啟動

### 3.1 系統需求

- **作業系統**: Windows 10 / 11
- **執行環境**: .NET Framework 4.7.2+（或 .NET 6+，視建置設定）
- **相依 DLL**:
  - `DIASECSGEM.dll`、`DIASECS.dll` — SECS/GEM 通訊核心
  - `DNGuard.Runtime.dll`、`DNGuard.HVM.dll` — DLL 保護（必須存在於執行目錄）
  - `dsa40net.dll`、`dmd40net.dll` — ETEL 運動控制器驅動
  - `Microsoft.Extensions.DependencyInjection` — DI 容器

### 3.2 啟動流程

1. 確認所有 DLL 檔案位於 `bin\Debug` 或 `bin\Release` 目錄下
2. 執行 `WaferMeasurementFlow.exe`
3. 系統自動建立 `Equipment` 實例，初始化所有子系統
4. 主畫面出現，兩組 Load Port 預設為 **閒置 (Empty)** 狀態

> ⚠️ **注意**: SecsManager 採用**延遲初始化**，只有在首次使用 SECS 功能時才會建立連線。若 DIASECSGEM DLL 缺失，只有在點擊「SECS 監控」按鈕時才會報錯，不影響其他功能使用。

---

## 4. 主畫面 (MainForm)

### 4.1 畫面配置

主畫面分為**左側控制面板**與**右側資訊面板**兩大區塊：

```
┌───────────────────────────────────────────────────────┐
│        晶圓量測流程系統 (Wafer Measurement Flow)        │
├──────────────┬────────────────────────────────────────┤
│              │                                        │
│  裝載埠狀態   │         晶圓狀態圖 (Wafer Slot Map)     │
│  Load Port 1 │   Slot │ Wafer ID     │ 狀態           │
│  Load Port 2 │   1    │ Wafer-1-01   │ 在席           │
│              │   2    │ Wafer-1-02   │ 處理中          │
│  當前載具: Cxxx│                                       │
│──────────────│────────────────────────────────────────│
│              │                                        │
│  系統操作     │         工單列表 (Job List)             │
│              │   類型 │ 工單 ID │ Recipe │ 狀態 │ 晶圓數 │
│  目標裝載埠:  │   CJ  │ CJ001  │ Meas  │ 執行中│  2    │
│  [Port 1 ▼]  │                                       │
│              │────────────────────────────────────────│
│  [放置載具]   │                                        │
│  [卸載載具]   │         系統日誌 (System Log)           │
│              │   [08:12:05] LoadPort 1: Carrier...    │
│  [建立工單]   │   [08:12:06] Robot: Moving to...      │
│  [Recipe 管理]   │   [08:12:07] ProcessManager: ...      │
│              │                                        │
│  [SECS 監控]  │                                        │
│  [ETEL 驅動]  │                                        │
└──────────────┴────────────────────────────────────────┘
```

### 4.2 左側控制面板

#### 裝載埠狀態區
- 顯示 **Load Port 1** 與 **Load Port 2** 的目前狀態
- 狀態以顏色指示燈呈現：
  - 🟢 **綠色**: 準備處理 (Ready to Process)
  - 🟡 **黃色**: 可卸載 (Ready to Unload)
  - 🔵 **藍色**: 載具在席 (Carrier Present)
  - ⚫ **灰色**: 閒置 (Empty)
  - 🔴 **紅色**: 其他過渡狀態 (Clamped / Door Open / Mapping)
- 顯示當前選取 Port 上的載具 ID

#### 系統操作區

- **目標裝載埠選擇**：下拉選單選擇操作的目標 Port (Port 1 / Port 2)
- **放置載具** (Place Carrier)：在選取的 Port 上放置一個模擬載具（含 2 片晶圓）
- **卸載載具** (Unload Carrier)：從 Port 取下載具（僅在 Ready to Unload 狀態可點擊）
- **建立工單** (Create PJ/CJ)：開啟「工單建立表單」
- **Recipe 管理** (Manage Recipes)：開啟「Recipe 編輯器」
- **SECS 監控** (SECS Monitor)：開啟「SECS/GEM 監控面板」
- **ETEL 驅動測試** (ETEL Test)：開啟「ETEL 驅動測試介面」

### 4.3 右側資訊面板

- **晶圓狀態圖 (Wafer Slot Map)**：顯示選取 Port 上載具中每個 Slot 的晶圓狀態
- **工單列表 (Job List)**：顯示所有 Control Job (CJ) 與 Process Job (PJ) 的狀態
- **系統日誌 (System Log)**：即時顯示所有系統事件的時間戳記日誌

---

## 5. 載具管理 (Carrier Management)

### 5.1 載具放置流程

點擊「放置載具」按鈕後，系統自動執行以下 E87 標準流程：

```
步驟 1: Carrier Placed
  └─ 載具放置到 Load Port → 狀態: CARRIER_PRESENT
  └─ [日誌] LoadPort X: Carrier 'Cxxx' placed.

步驟 2: E87 Carrier ID Verification
  └─ 呼叫 E87Manager.VerifyCarrierId()
  └─ 驗證通過 → 繼續流程
  └─ 驗證失敗 → 中止流程 (Error 訊息)

步驟 3: Clamp Carrier
  └─ 載具夾持 → 狀態: CLAMPED
  └─ [延遲 500ms 模擬]

步驟 4: Open Door
  └─ 艙門開啟 → 狀態: DOOR_OPEN
  └─ [延遲 1000ms 模擬]

步驟 5: Wafer Mapping
  └─ 掃描載具中所有 Slot → 狀態: MAPPING
  └─ 逐一回報偵測到的晶圓

步驟 6: E87 Slot Map Verification
  └─ 呼叫 E87Manager.VerifySlotMap()
  └─ 驗證通過 → 狀態: READY_TO_PROCESS
  └─ 驗證失敗 → 中止流程
```

### 5.2 載具自動命名

放置載具時，系統自動產生載具 ID，格式為 `C` + 3 位數字（取自系統 Tick 數餘數），例如 `C042`。每個載具預設含 2 片晶圓：
- Slot 1: `Wafer-{PortId}-01`
- Slot 2: `Wafer-{PortId}-02`

### 5.3 載具卸載

- 僅在 Port 狀態為 **READY_TO_UNLOAD** 時可執行卸載
- 卸載後 Port 恢復 **EMPTY** 狀態
- 晶圓加工完成後，Port 會自動轉為 READY_TO_UNLOAD

---

## 6. 工單管理 (PJ/CJ 建立與執行)

### 6.1 概念説明

系統遵循 SEMI E40/E94 標準的兩層工單模型：

| 層級 | 名稱 | 標準 | 說明 |
|------|------|------|------|
| 上層 | **Control Job (CJ)** | SEMI E94 | 控制工單，管理整體加工排程，包含一至多個 PJ |
| 下層 | **Process Job (PJ)** | SEMI E40 | 製程工單，定義使用的 Recipe 與要處理的晶圓 |

### 6.2 建立工單 (PJCJCreationForm)

點擊主畫面的「建立工單」按鈕開啟工單建立表單：

#### 操作步驟

1. **選擇來源 Load Port**：從下拉選單選擇有載具的 Port
2. **選擇 Recipe (Recipe)**：選擇要使用的量測 Recipe
3. **指定目標 Slot**：可選擇處理特定 Slot 或全部
4. **確認晶圓清單**：下方 DataGridView 會顯示要處理的晶圓
5. **點擊「建立並啟動工單」**：
   - 系統自動建立 PJ（`PJ_{timestamp}`）
   - 系統自動建立 CJ（`CJ_{timestamp}`），將 PJ 歸屬其下
   - 自動開始執行 CJ

### 6.3 自動化執行流程

CJ 執行時，系統自動對每片晶圓執行以下流程：

```
CJ 執行開始 (State: EXECUTING)
│
├── PJ 執行開始
│   │
│   ├── 對每一片晶圓:
│   │   ├── 1. WaferManager 註冊晶圓
│   │   ├── 2. Robot 移動到 LoadPort → 取晶圓 (Pick)
│   │   ├── 3. Robot 移動到 Aligner → 放置晶圓
│   │   ├── 4. Aligner 執行對位 (Align)
│   │   ├── 5. Robot 移動晶圓到 ProcessChamber
│   │   ├── 6. ProcessManager 執行量測加工 (2 秒模擬)
│   │   ├── 7. Robot 從 ProcessChamber 取回晶圓
│   │   └── 8. Robot 放回載具原始 Slot
│   │
│   └── PJ 完成
│
└── CJ 完成 (State: COMPLETED)
    └── LoadPort 狀態變更為 READY_TO_UNLOAD
```

### 6.4 工單狀態

| 狀態 | 中文 | 說明 |
|------|------|------|
| QUEUED | 排隊中 | CJ 已建立，等待執行 |
| EXECUTING | 執行中 | CJ 正在執行 PJ |
| COMPLETED | 已完成 | 所有 PJ 執行完畢 |
| PAUSED | 已暫停 | CJ 被暫停（保留功能） |
| ABORTED | 已中止 | CJ 被中止（保留功能） |

---

## 7. Recipe 管理 (Recipe Editor)

### 7.1 開啟方式

主畫面 → 點擊「Recipe 管理」按鈕

### 7.2 功能說明

Recipe 編輯器提供完整的 CRUD 操作：

#### 新增 Recipe
1. 點擊「新增」按鈕
2. 輸入 Recipe ID（名稱）
3. 在參數表格中填入量測參數（Key-Value 格式）
4. 設定目標 Slot（例如 `1,2,3` 或 `1-5` 或 `ALL`）
5. 點擊「儲存」

#### 編輯 Recipe
1. 從左側 Recipe 清單選擇要編輯的 Recipe
2. 右側自動載入 Recipe 內容
3. 修改參數後點擊「儲存」

#### 刪除 Recipe
1. 選擇 Recipe
2. 點擊「刪除」按鈕

### 7.3 預設 Recipe

系統啟動時自動建立預設 Recipe：

| Recipe ID | 參數 |
|---------|------|
| `MeasureWafer` | Temp: 25C, Duration: 60s |

### 7.4 Recipe 參數格式

| 欄位 | 說明 | 範例 |
|------|------|------|
| Recipe ID | Recipe 唯一識別碼 | `MeasureWafer` |
| Parameters | 量測參數，以 Key-Value 儲存 | `{"Temp": "25C", "Duration": "60s"}` |
| Target Slots | 適用的 Slot 範圍 | `1,2,3` / `1-5` / `ALL` |

---

## 8. SECS/GEM 監控 (SecsMonitorForm)

### 8.1 開啟方式

主畫面 → 點擊「SECS 監控」按鈕

> ⚠️ 首次開啟會初始化 `SecsManager`，若 DIASECSGEM DLL 不存在會跳出錯誤訊息。

### 8.2 畫面配置

```
┌─────────────────────────────────────────────────────┐
│  SECS/GEM Monitor  v2.0                             │
├──────────────────────────┬──────────────────────────┤
│                          │                          │
│  系統狀態總覽              │      系統日誌             │
│  ┌──────┐  ┌──────┐     │                          │
│  │初始化 │  │驅動連線│     │  [08:12:05] 初始化完成   │
│  │  成功 │  │ 已連線 │     │  [08:12:06] Driver...   │
│  └──────┘  └──────┘     │  [08:12:07] S1F13...     │
│  ┌──────┐  ┌──────┐     │                          │
│  │通訊狀態│  │控制模式│     │                          │
│  │ 通訊中 │  │遠端控制│     │                          │
│  └──────┘  └──────┘     │                          │
│──────────────────────────│                          │
│                          │                          │
│  操作面板                 │                          │
│  [啟動驅動] [停止驅動]     │                          │
│  [啟用通訊] [禁用通訊]     │                          │
│  [OFFLINE] [LOCAL]       │                          │
│  [REMOTE]                │                          │
│──────────────────────────│                          │
│                          │                          │
│  操作說明                 │                          │
│  (狀態說明 / 操作流程)     │                          │
│                          │                          │
└──────────────────────────┴──────────────────────────┘
```

### 8.3 系統狀態總覽

四個狀態指示器，以顏色即時反映系統狀態：

| 指示器 | 說明 | 🟢 綠色 | 🟡 黃色 | 🔴 紅色 | ⚫ 灰色 |
|--------|------|---------|---------|---------|---------|
| 初始化 | DIASECSGEM 控制器初始化 | 成功 | — | 失敗 | 等待中 |
| 驅動連線 | TCP/IP 通訊層連線 | 已連線 | 連線中 / 等待連入 | — | 未連線 |
| 通訊狀態 | S1F13 通訊握手 | 通訊中 | — | 已禁用 / 未通訊 | — |
| 控制模式 | 設備控制狀態模型 | Remote | Local | 離線 | — |

### 8.4 操作面板

#### 驅動控制
| 按鈕 | 功能 | 可用條件 |
|------|------|---------|
| **啟動驅動** | 啟動 TCP/IP Driver，建立與 Host 的傳輸層連線 | Driver 為 Disconnected |
| **停止驅動** | 停止 Driver 連線 | Driver 非 Disconnected |

#### 通訊控制
| 按鈕 | 功能 | 可用條件 |
|------|------|---------|
| **啟用通訊** | 發送 S1F13 (Establish Communication Request) | Driver 已連線 且 尚未通訊 |
| **禁用通訊** | 停止通訊 | 通訊非 Disabled |

#### 控制模式
| 按鈕 | 功能 | 可用條件 |
|------|------|---------|
| **OFFLINE** | 設備離線，不接受 Host 指令 | 通訊中 且 非 Offline |
| **LOCAL** | 本地控制模式 — Operator 可以操作面板 | 通訊中 且 非 Local |
| **REMOTE** | 遠端控制模式 — Host 完全控制設備 | 通訊中 且 非 Remote |

### 8.5 標準操作流程

```
1. 點擊「啟動驅動」
   └─ 建立 TCP 連線，等待 Driver 狀態變為 Connected

2. 點擊「啟用通訊」
   └─ 發送 S1F13 握手，等待 Communicating 狀態

3. 切換控制模式
   └─ 依需求選擇 OFFLINE / LOCAL / REMOTE
```

### 8.6 GEM 通訊方法對照

SecsManager 提供以下 GEM 方法供其他模組呼叫：

| 方法 | 用途 |
|------|------|
| `UpdateLoadPortAccessMode()` | 更新 Load Port 存取模式 |
| `UpdateLoadPortTransferState()` | 更新 Load Port 傳輸狀態 |
| `CreateCarrier()` / `DeleteCarrier()` | 建立/刪除 Carrier 物件 |
| `CreateSubstrate()` | 建立 Substrate 物件 |
| `ChangeControlJobState()` | 變更 CJ 狀態 |
| `ChangeProcessJobState()` | 變更 PJ 狀態 |
| `UpdateSV()` / `UpdateEC()` | 更新 Status Variable / Equipment Constant |
| `EventReportSend()` | 發送事件報告 |
| `AlarmReportSend()` | 發送警報報告 |

---

## 9. ETEL 驅動測試 (EtelTestForm)

### 9.1 開啟方式

主畫面 → 點擊「ETEL 驅動測試」按鈕

### 9.2 功能說明

提供對 ETEL 運動控制器的基礎連線與參數讀寫測試介面。

### 9.3 連線操作

1. 在「裝置 URL」欄位輸入 ETEL 裝置連線位址
2. 點擊「連線」建立與 ETEL 控制器的連線
3. 連線成功後，狀態指示器變為綠色
4. 點擊「斷線」可中斷連線

### 9.4 參數讀取

1. 選擇參數類型 (Type)
2. 輸入參數索引 (Index) 與子索引 (Sub-Index)
3. 點擊「讀取」
4. 讀取結果會顯示在 Value 欄位與日誌區

### 9.5 參數寫入

1. 選擇參數類型、索引、子索引
2. 在 Value 欄位輸入要寫入的值
3. 點擊「寫入」
4. 寫入結果會記錄在日誌區

### 9.6 ETEL Manager API

| 方法 | 說明 |
|------|------|
| `Connect(url)` | 建立與 ETEL 裝置的連線 |
| `Disconnect()` | 中斷連線 |
| `ReadParameter(type, index, subIndex)` | 讀取指定參數 |
| `WriteParameter(type, index, subIndex, value)` | 寫入指定參數 |

> ⚠️ 需確保 `dsa40net.dll` 與 `dmd40net.dll` 存在於執行目錄。

---

## 10. 系統事件與日誌

### 10.1 日誌位置

- **主畫面 → 系統日誌區**：即時顯示所有系統事件
- **SECS 監控 → 系統日誌區**：僅顯示 SECS/GEM 相關事件
- **ETEL 測試 → 日誌區**：僅顯示 ETEL 操作事件
- **Console 輸出**：LogSystem 同時輸出至 Console (Info/Error) 與 Debug Output

### 10.2 日誌格式

```
[HH:mm:ss] {訊息來源}: {事件描述}
```

範例：
```
[08:12:05] LoadPort 1: Carrier 'C042' placed.
[08:12:06] E87Manager: Verifying Carrier ID 'C042'...
[08:12:06] E87Manager: Carrier ID 'C042' verification Passed.
[08:12:07] LoadPort 1: Clamping carrier 'C042'.
[08:12:07] LoadPort 1: Opening door for carrier 'C042'.
[08:12:08] LoadPort 1: Mapping wafers in carrier 'C042'.
[08:12:08]   - Found Wafer 'Wafer-1-01' in Slot 1.
[08:12:08]   - Found Wafer 'Wafer-1-02' in Slot 2.
[08:12:09] E87Manager: Slot Map verification Passed.
[08:12:09] LoadPort 1: Carrier 'C042' is ready for wafer processing (E87 Verified).
```

### 10.3 事件匯流排 (SystemEventBus)

所有模組均透過 `SystemEventBus` 發布事件與日誌，UI 層訂閱後即時更新畫面。

---

## 11. 狀態定義與參考

### 11.1 Load Port 狀態

| 狀態 | 中文 | 說明 |
|------|------|------|
| `EMPTY` | 閒置 | 無載具在 Port 上 |
| `CARRIER_PRESENT` | 載具在席 | 載具已放置但未夾持 |
| `CLAMPED` | 已夾持 | 載具已被機構夾持固定 |
| `DOOR_OPEN` | 艙門開啟 | 載具艙門已開啟 |
| `MAPPING` | 掃描中 | 正在掃描 Slot Map |
| `READY_TO_PROCESS` | 準備處理 | E87 驗證通過，可開始加工 |
| `READY_TO_UNLOAD` | 可卸載 | 所有晶圓加工完成，可取下載具 |

### 11.2 晶圓 (Substrate) 狀態

| 狀態 | 中文 | 說明 |
|------|------|------|
| `UNKNOWN` | 未知 | 初始未確認狀態 |
| `EMPTY` | 空 | Slot 內無晶圓 |
| `PRESENT` | 在席 | 晶圓在載具 Slot 中 |
| `PICKED` | 已取走 | 被 Robot 取出載具 |
| `PROCESSING` | 處理中 | 正在 ProcessChamber 加工 |
| `PROCESSED` | 已完成 | 加工完成 |

### 11.3 機器手臂 (Robot) 狀態

| 狀態 | 說明 |
|------|------|
| `IDLE` | 閒置，可接受新任務 |
| `MOVING_TO_SOURCE` | 移動至取料位置 |
| `PICKING` | 正在取晶圓 |
| `MOVING_TO_DEST` | 移動至放料位置 |
| `PUTTING` | 正在放置晶圓 |
| `MOVING_HOME` | 返回原點 |

### 11.4 對位器 (Aligner) 狀態

| 狀態 | 說明 |
|------|------|
| `IDLE` | 閒置 |
| `ALIGNING` | 正在對位 |
| `COMPLETED` | 對位完成 |
| `ERROR` | 對位失敗 |

### 11.5 SECS 通訊狀態

| 類別 | 值 | 說明 |
|------|-----|------|
| **SecsDriverState** | `Disconnected` | 未連線 |
| | `Connecting` | 正在連線 |
| | `Listening` | 等待 Host 連入 |
| | `Connected` | 已連線 |
| **SecsCommState** | `Disabled` | 通訊已禁用 |
| | `NotCommunicating` | 未通訊 |
| | `WaitCRFromHost` | 等待 Host 回覆 |
| | `WaitDelay` | 延遲等待 |
| | `Communicating` | 通訊中 |
| **SecsControlMode** | `EquipmentOffline` | 設備離線 |
| | `HostOffline` | Host 離線 |
| | `OnlineLocal` | 本地控制 |
| | `OnlineRemote` | 遠端控制 |

---

## 12. 錯誤排除 (Troubleshooting)

### 12.1 SECS Manager 無法初始化

**症狀**: 點擊「SECS 監控」後出現 `TypeInitializationException` 錯誤

**原因**: DIASECSGEM DLL 或其相依的 DNGuard Runtime 檔案缺失

**解決方案**:
1. 確認以下檔案存在於應用程式執行目錄：
   - `DIASECSGEM.dll`
   - `DIASECS.dll`
   - `DNGuard.Runtime.dll`
   - `DNGuard.HVM.dll`
2. 右鍵點擊 DLL → 「內容」 → 勾選「解除封鎖」
3. 確認未被防毒軟體隔離
4. 聯繫 DIASECSGEM 供應商獲取完整安裝套件

### 12.2 放置載具失敗

**症狀**: 點擊「放置載具」後出現 "Not EMPTY" 訊息

**原因**: 選取的 Load Port 目前不是 EMPTY 狀態（已有載具或正在處理中）

**解決方案**: 先卸載該 Port 上的現有載具，或選擇另一個空閒 Port。

### 12.3 卸載載具失敗

**症狀**: 「卸載載具」按鈕灰色不可點擊

**原因**: Port 不在 `READY_TO_UNLOAD` 或 `READY_TO_PROCESS` 狀態

**解決方案**: 等待加工流程完成（CJ 狀態變為 COMPLETED），Port 會自動轉為 READY_TO_UNLOAD。

### 12.4 ETEL 連線失敗

**症狀**: ETEL 連線時出現 DLL 載入錯誤

**原因**: `dsa40net.dll` 或 `dmd40net.dll` 缺失

**解決方案**: 確認 ETEL SDK 已正確安裝，相關 DLL 位於執行目錄或系統 PATH 中。

### 12.5 建立工單時沒有可選的 Load Port

**原因**: 所有 Load Port 上都沒有載具，或載具尚未完成 E87 驗證

**解決方案**: 先在至少一個 Port 上放置載具，等待其達到 READY_TO_PROCESS 狀態。

---

## 13. 附錄：SEMI 標準對照

本系統所遵循的 SEMI 國際半導體標準：

| 標準 | 名稱 | 本系統對應模組 |
|------|------|---------------|
| **SEMI E4** | SECS-II (Message Content) | `SecsManager` 訊息封裝 |
| **SEMI E5** | SECS-II Equipment Message | `SecsManager` 訊息定義 |
| **SEMI E30** | GEM (Generic Equipment Model) | `SecsManager` GEM 狀態模型 |
| **SEMI E37** | HSMS (High Speed Message Service) | `SecsManager` TCP/IP Driver |
| **SEMI E40** | Processing Management | `ControlJobAgent.CreateProcessJob()` |
| **SEMI E87** | Carrier Management (CMS) | `E87Manager`, `LoadPortAgent` |
| **SEMI E90** | Substrate Tracking | `WaferManager` |
| **SEMI E94** | Control Job Management | `ControlJobAgent.CreateControlJob()` |

---

> **版權聲明**: 本系統使用 Delta DIASECSGEM SDK 進行 SECS/GEM 通訊，ETEL 驅動使用 ETEL SA 原生 .NET SDK。
